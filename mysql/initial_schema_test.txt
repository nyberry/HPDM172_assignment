# These are some initial tests run 29/11/2025 13:00 to check that the schema.sql works as expected
# No password (leave blank)

nyberry@Nicks-MacBook-Air HPDM172_assignment % mysql -u root -p < /Users/nyberry/Desktop/Exeter/HPDM172/HPDM172_assignment/mysql/schema.sql

Enter password: 
nyberry@Nicks-MacBook-Air HPDM172_assignment % mysql -u root -p

Enter password: 
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 15
Server version: 9.5.0 Homebrew

Copyright (c) 2000, 2025, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> USE hospitaldb;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql> SHOW TABLES;
+----------------------+
| Tables_in_hospitaldb |
+----------------------+
| Appointment          |
| Disease              |
| DiseaseSpecialist    |
| DiseaseTreatment     |
| Doctor               |
| Hospital             |
| LabResult            |
| LabTest              |
| Medication           |
| Patient              |
| Prescription         |
+----------------------+
11 rows in set (0.001 sec)

# Insert some data into the tables

mysql> INSERT INTO Hospital (name, address, beds, accreditation_status) VALUES ('St Mary Hospital', '1 Main Street', 250, 'Accredited');
Query OK, 1 row affected (0.003 sec)

mysql> INSERT INTO Doctor (hospital_id, first_name, last_name, date_of_birth, specialty, accreditation_date, address)
    -> VALUES (1, 'Alice', 'Roberts', '1979-04-12', 'Cardiology', '2010-06-01', '20 Doctor Lane');
Query OK, 1 row affected (0.002 sec)

mysql> INSERT INTO Patient (doctor_id, first_name, last_name, date_of_birth, address, gender)
    -> VALUES (1, 'John', 'Smith', '1985-09-20', '88 Patient Rd', 'Male');
Query OK, 1 row affected (0.001 sec)

mysql> INSERT INTO Medication (name)
    -> VALUES ('Atorvastatin');
Query OK, 1 row affected (0.001 sec)

mysql> INSERT INTO Prescription (patient_id, doctor_id, medication_id, prescribed_date, dose_instructions, duration_days, route)
    -> VALUES (1, 1, 1, '2025-01-01', 'Take 1 tablet daily', 30, 'Oral');
Query OK, 1 row affected (0.001 sec)

mysql> INSERT INTO LabTest (name, description, units, reference_range, sample_type)
    -> VALUES ('Cholesterol', 'Serum total cholesterol', 'mmol/L', '3.5-5.2', 'Blood');
Query OK, 1 row affected (0.002 sec)

mysql> INSERT INTO LabResult (lab_test_id, patient_id, doctor_id, requested_date, result_date, result_value, is_normal, notes)
    -> VALUES (1, 1, 1, '2025-01-02', '2025-01-03', '6.1', 0, 'High cholesterol');
Query OK, 1 row affected (0.001 sec)

mysql> describe Hospital;
+----------------------+--------------+------+-----+---------+----------------+
| Field                | Type         | Null | Key | Default | Extra          |
+----------------------+--------------+------+-----+---------+----------------+
| hospital_id          | int          | NO   | PRI | NULL    | auto_increment |
| name                 | varchar(150) | NO   | UNI | NULL    |                |
| address              | varchar(255) | NO   |     | NULL    |                |
| beds                 | int          | NO   |     | NULL    |                |
| accreditation_status | varchar(100) | YES  |     | NULL    |                |
+----------------------+--------------+------+-----+---------+----------------+
5 rows in set (0.001 sec)

# List all hospitals:

mysql> SELECT * FROM Hospital;
+-------------+------------------+---------------+------+----------------------+
| hospital_id | name             | address       | beds | accreditation_status |
+-------------+------------------+---------------+------+----------------------+
|           1 | St Mary Hospital | 1 Main Street |  250 | Accredited           |
+-------------+------------------+---------------+------+----------------------+
1 row in set (0.000 sec)

# List each doctor along with the hospital they work in:

mysql> SELECT d.first_name, d.last_name, h.name AS hospital
    -> FROM Doctor d
    -> JOIN Hospital h ON d.hospital_id = h.hospital_id;
+------------+-----------+------------------+
| first_name | last_name | hospital         |
+------------+-----------+------------------+
| Alice      | Roberts   | St Mary Hospital |
+------------+-----------+------------------+
1 row in set (0.001 sec)

# List each patient with their doctor and hospital:

mysql> SELECT p.first_name AS patient, p.last_name AS patient_last,
    ->        d.first_name AS doctor, d.last_name AS doctor_last,
    ->        h.name AS hospital
    -> FROM Patient p
    -> JOIN Doctor d ON p.doctor_id = d.doctor_id
    -> JOIN Hospital h ON d.hospital_id = h.hospital_id;
+---------+--------------+--------+-------------+------------------+
| patient | patient_last | doctor | doctor_last | hospital         |
+---------+--------------+--------+-------------+------------------+
| John    | Smith        | Alice  | Roberts     | St Mary Hospital |
+---------+--------------+--------+-------------+------------------+
1 row in set (0.001 sec)

# list each prescription with name, dose and prescribed date:

mysql> SELECT p.patient_id, m.name AS medication, pr.dose_instructions, pr.prescribed_date
    -> FROM Prescription pr
    -> JOIN Medication m ON pr.medication_id = m.medication_id
    -> JOIN Patient p ON pr.patient_id = p.patient_id;
+------------+--------------+---------------------+-----------------+
| patient_id | medication   | dose_instructions   | prescribed_date |
+------------+--------------+---------------------+-----------------+
|          1 | Atorvastatin | Take 1 tablet daily | 2025-01-01      |
+------------+--------------+---------------------+-----------------+
1 row in set (0.001 sec)

# List each lab result with name, value, patient and whether it is normal:

mysql> SELECT 
    ->     lr.result_value,
    ->     lr.is_normal,
    ->     lt.name AS test_name,
    ->     p.first_name,
    ->     p.last_name
    -> FROM LabResult lr
    -> JOIN LabTest lt ON lr.lab_test_id = lt.lab_test_id
    -> JOIN Patient p ON lr.patient_id = p.patient_id;
+--------------+-----------+-------------+------------+-----------+
| result_value | is_normal | test_name   | first_name | last_name |
+--------------+-----------+-------------+------------+-----------+
| 6.1          |         0 | Cholesterol | John       | Smith     |
+--------------+-----------+-------------+------------+-----------+
1 row in set (0.001 sec)